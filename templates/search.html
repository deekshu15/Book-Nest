{% extends "base.html" %}
{% block content %}
<style>
  .glass-container.search-page {
    max-width: 1200px;
    width: 100%;
    margin: 2rem auto;   /* âœ… centers it */
    display: block;
    position: static !important;
    left: auto !important;
    transform: none !important;
    transition: none !important;
  }

  .book-table {
    width: 100%;
    max-width: 1100px;
    margin: 2rem auto;
    border-collapse: collapse;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    overflow: hidden;
  }

  .book-table th,
  .book-table td {
    padding: 12px 16px;
    text-align: left;
  }

  .book-table thead {
    background: rgba(255, 255, 255, 0.15);
  }

  .book-table tbody tr:nth-child(even) {
    background: rgba(255, 255, 255, 0.05);
  }
</style>

<div class="glass-container search-page">
  <h2>Seek the Scrolls</h2>
  <p class="subtitle">Discover ancient wisdom and modern insights.</p>

  <form method="POST" action="{{ url_for('search') }}">
    <div class="form-group">
      <label for="searchInput">Search by Title, Author, or Department</label>
      <input type="text" id="searchInput" name="search_query" class="form-control"
             placeholder="e.g., 'Dune', 'History', 'Jane Austen'" value="{{ search_query }}">
    </div>

    <div class="form-group">
      <label for="categoryFilter">Department</label>
      <select id="categoryFilter" name="categoryFilter" class="form-control">
        <option value="All Categories" {% if category_filter == 'All Categories' or category_filter == '' %}selected{% endif %}>All Categories</option>
        <option value="CSE" {% if category_filter == 'CSE' %}selected{% endif %}>CSE</option>
        <option value="ECE" {% if category_filter == 'ECE' %}selected{% endif %}>ECE</option>
        <option value="EEE" {% if category_filter == 'EEE' %}selected{% endif %}>EEE</option>
        <option value="CIV" {% if category_filter == 'CIV' %}selected{% endif %}>CIV</option>
        <option value="ME" {% if category_filter == 'ME' %}selected{% endif %}>ME</option>
        <option value="MBA" {% if category_filter == 'MBA' %}selected{% endif %}>MBA</option>
        <option value="MCA" {% if category_filter == 'MCA' %}selected{% endif %}>MCA</option>
      </select>
    </div>

    <div class="form-group">
      <label for="availabilityFilter">Availability</label>
      <select id="availabilityFilter" name="availabilityFilter" class="form-control">
        <option value="" {% if availability_filter == '' %}selected{% endif %}>All Books</option>
        <option value="Available" {% if availability_filter == 'Available' %}selected{% endif %}>Available</option>
        <option value="Checked Out" {% if availability_filter == 'Checked Out' %}selected{% endif %}>Checked Out</option>
        <option value="Reserved" {% if availability_filter == 'Reserved' %}selected{% endif %}>Reserved</option>
      </select>
    </div>

    <button type="submit" class="btn-primary">Search</button>
  </form>

  {% if books %}
  <table class="book-table">
    <thead>
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Department</th>
        <th>Year</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for book in books %}
      <tr>
        <td>{{ book.title }}</td>
        <td>{{ book.author }}</td>
        <td>{{ book.department }}</td>
        <td>{{ book.year }}</td>
        <td><span class="status {{ book.status | lower | replace(' ', '-') }}">{{ book.status }}</span></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="subtitle" style="margin-top: 2rem;">No books found. Try again.</p>
  {% endif %}
</div>
{% endblock %}